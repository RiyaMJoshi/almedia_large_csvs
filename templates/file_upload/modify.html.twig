{% extends 'base.html.twig' %}

{% block title %}Modify Your CSV - A|L Media{% endblock %}

{# {% block stylesheets %}
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" />
<link rel="stylesheet" href="bootstrap-iconpicker/css/bootstrap-iconpicker.min.css">
{% endblock %} #}


{% block body %}

<div class="example-wrapper">
	    {# {% if error != null %}
        <div class="alert alert-danger alert-dismissible d-flex align-items-center fade show" role="alert">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-exclamation-triangle-fill flex-shrink-0 me-2" viewBox="0 0 16 16" role="img" aria-label="Warning:">
                <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
            </svg>
            <div>
                {{ error }}
                <span type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></span>
            </div>
        </div>
    {% endif %} #}
	<h1>Manage Your Large CSVs</h1>
	{# <span class="mb-4">Make CSV files easy to operate by managing them in various ways.</span> #}
	<span class="mb-4">Reorder, Rename or Delete Your CSV Columns in an easier way.</span>

	<div class="my-4">

		<div class="card my-2" style="width: 50rem;">
			<div class="card-header">
				<h5 class="float-left">Columns</h5>
			</div>
			<div class="card-body">
				<div data-role="page" id="viewInformation" data-theme="d" data-add-back-btn="true"
					data-back-btn-text="back">
					<div data-role="header" id="headerid" class="ui-bar ui-bar-b">
						{# {{ filename }} #}
						<form class="form-group">
							<ul class="list-group" id="sortable">
								{% for column in columns %}
								
								<script></script>
								<li data-role="content" class="input-group d-flex mb-3" id="contentid">
									<span class="input-group-text"><i class='fa fa-sort'></i></span>
									<input class="form-control list-group-item fs-6" style="width:90%" name="text[]" value="{{column}}"/>
									<input type="hidden" name="original_cols[]" value="{{column}}">
									<span class="input-group-text deleteCol bg-danger"><i class="fa fa-trash"></i></span>
								</li>
								{% endfor %}
								<input type="hidden" name="filename" value="{{ filename }}">
								<div>
									<input type="submit" id="export_csv" class="btn btn-dark me-md-2" style="width:20%" value="Export CSV" formaction="{{path('app_export', {'format': 'csv'})}}">
									<input type="submit" id="export_zip" class="btn btn-dark me-md-2" style="width:20%" value="Export ZIP" formaction="{{path('app_export', {'format': 'zip'})}}">
								</div>
							</ul>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
	{% block javascripts %}
		<script type="text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>
		<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
		<script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
	<script>
		window.onbeforeunload = function () {
    		return "";
 		};
		$(function () {
			$("#sortable").sortable();

			/*
			$("#export_csv").click(function() {
                $.ajax({
						url: "/export", 
						type: "POST",
						data: $("form").serialize(),
                        success: function(result) {
                    console.log(result.blob());
                }});
            });
			*/
		});

		// Redirect after 10 seconds on clicking Export
		$(document).on('submit', 'form', function() {
			$(this).find(':submit').attr('disabled','disabled');
		setTimeout(function() {
			window.location = "/";
		}, 100000);
		});
        
        $(".deleteCol").click(function(){
            if(confirm('Are you sure you want to delete this column?')) {
                console.log('Yes');
                var curr = $(this).parent().children();
                console.log(curr);
                $(this).parent().remove();
            } else {
                console.log('No');
            }
            
        });
	</script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
	{% endblock %}
	{% endblock %}